<!DOCTYPE HTML>
<html>

<head>
    <title>IA MACHINE LEARNING - Regresión Lineal y Polinomial</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="./dist/tytus.js"></script>
    <link rel="stylesheet" href="./assets/css/main.css" />

</head>

<body class="container my-4">
    <div id="sidebar">
        <h2>Modelos de ML</h2>
        <a href="#" onclick="mostrarVista('lineal')">Linear Regression</a>
        <a href="#" onclick="mostrarVista('polinomial')">Polynomial Regression</a>
        <a href="#" onclick="mostrarVista('decision-tree')">Decision Tree</a>
        <a href="#" onclick="mostrarVista('naive-bayes')">Naive Bayes</a>
        <a href="#" onclick="mostrarVista('newronal')">Neuronal Network</a>
        <a href="#" onclick="mostrarVista('seccionkmeans')">KMeans</a>
        <a href="#">K-Nearest Neighbor</a>
    </div>

    <div id="header-container">
        <h1 class="text-center" id="encabezado">Configuración y Análisis de Modelos de IA</h1>
    </div>

    <!-- Contenido principal -->
    <div class="content" id="main-conteiner">
        <!-- Selección y parametrización del modelo -->
        <section id="parametrizacion" class="border p-3 rounded my-3" style="display: none;">
            <h2 class="text-primary">Parametrización del Modelo</h2>
            <div class="row">
                <!-- Objetivo -->
                <div class="col-md-4">
                    <label for="objetivo">Objetivo del Modelo:</label>
                    <select id="objetivo" class="form-select" onchange="habilitarCampos()">
                        <option value="tendencia">Tendencia (Regresión Lineal)</option>
                        <option value="clasificacion">Clasificación</option>
                        <option value="prediccion">Predicción</option>
                    </select>
                </div>

                <!-- Porcentaje de Train/Test -->
                <div class="col-md-4">
                    <label for="porcentajeTrain">Porcentaje de datos para entrenamiento:</label>
                    <input type="number" id="porcentajeTrain" class="form-control" min="1" max="99" value="70">%
                </div>

                <!-- Input para archivo CSV -->
                <div class="col-md-4 mt-3">
                    <label for="csvFile">Cargar Dataset (CSV):</label>
                    <input type="file" id="csvFile" class="form-control" accept=".csv">
                    <button onclick="cargarDataset()" class="btn btn-secondary mt-2">Cargar Dataset</button>
                </div>

                <!-- Rango para Predicción -->
                <div class="col-md-4 mt-3">
                    <label for="rangoPrediccion">Rango para Predicción (si aplica):</label>
                    <input type="text" id="rangoPrediccion" class="form-control" placeholder="Ejemplo: 5, 6, 7"
                        disabled>
                </div>

                <!-- Grado del Polinomio -->
                <div class="col-md-4 mt-3">
                    <label for="gradoPolinomio">Grado del Polinomio (para regresión polinomial):</label>
                    <input type="number" id="gradoPolinomio" class="form-control" min="1" placeholder="Ejemplo: 2"
                        disabled>
                </div>

                <!-- Botón para configurar modelo -->
                <div class="col-md-4 mt-3">
                    <button onclick="configurarModelo()" class="btn btn-primary mt-4">Configurar Modelo</button>
                </div>
            </div>
        </section>
        <!-- Selección de columnas para X e Y -->
        <section id="seleccionColumnas" class="border p-3 rounded my-3" style="display: none;">
            <h2 class="text-secondary">Seleccionar Columnas para Análisis</h2>
            <div class="row">
                <div class="col-md-6">
                    <label for="columnaX">Columna para Variables de Entrada (X):</label>
                    <select id="columnaX" class="form-select"></select>
                </div>
                <div class="col-md-6">
                    <label for="columnaY">Columna para Variable de Salida (Y):</label>
                    <select id="columnaY" class="form-select"></select>
                </div>
            </div>
        </section>
        <!-- Tabla para mostrar datos cargados -->
        <section id="datosCargados" class="border p-3 rounded my-3" style="display: none;">
            <h2 class="text-secondary">Datos Cargados</h2>
            <div id="tablaDatosContainer">
                <table class="table table-striped">
                    <thead id="tablaHeader"></thead>
                    <tbody id="tablaDatos"></tbody>
                </table>
            </div>
        </section>


        <!-- Contenido de Regresión Lineal -->
        <section id="lineal" class="border p-3 rounded my-3" style="display: none;">
            <h2 class="text-success">Regresión Lineal</h2>
            <button onclick="entrenarModelo('lineal')" class="btn btn-success">Entrenar</button>
            <button onclick="realizarOperacion('lineal')" class="btn btn-secondary">Realizar Predicción</button>
            <div id="graficaLineal" class="mt-3" style="width: 100%; height: 500px;"></div>
        </section>

        <!-- Contenido de Regresión Polinomial -->
        <section id="polinomial" class="border p-3 rounded my-3" style="display: none;">
            <h2 class="text-warning">Regresión Polinomial</h2>
            <button onclick="entrenarModelo('polinomial')" class="btn btn-warning">Entrenar</button>
            <button onclick="realizarOperacion('polinomial')" class="btn btn-secondary">Realizar Predicción</button>
            <div id="graficaPolinomial" class="mt-3" style="width: 100%; height: 500px;"></div>
        </section>
        <!-- Contenido de Decision Tree -->
        <section id="decision-tree">
            <article class="box post post-excerpt">
                <header>
                    <h2 id="title-desiciontree">Generar Árbol de Decisión</h2>
                    <p></p>
                </header>

                <center>
                    <!-- Cargar archivo CSV -->
                    <label>Seleccionar archivo CSV</label>
                    <br>
                    <input type="file" id="fileInput" accept=".csv" />
                    <br><br>

                    <!-- Vista previa de datos -->
                    <div id="preview" style="overflow: auto; max-height: 200px; max-width: 80%;"></div>
                    <br>

                    <!-- Botones -->
                    <button id="btngenerate">Generar árbol de decisión</button>
                    <br><br>
                    <label>Predicción</label>
                    <br>
                    <input style="width: 80%;" id="data" type="text" placeholder="Insertar datos para predecir"
                        value="Medium,Short,No,Yes,No">
                    <br><br>
                    <button id="predict">Predecir con datos insertados</button>
                    <br><br>
                    <p id="prediction" style="font-size: 20px;"></p>
                </center>
                <br>

                <h3 class="display-6 text-center mt-5">Resultado del árbol:<br /></h3>
                <div class="container mb-5">
                    <div style="width: 100%; height: 500px; border: 2px solid rgb(96, 160, 255); border-radius: 10px;"
                        id="treed"></div>
                </div>

                <script type="text/javascript">
                    let csvData = [];

                    // Función para cargar archivo CSV
                    document.getElementById('fileInput').addEventListener('change', (event) => {
                        const file = event.target.files[0];
                        const reader = new FileReader();

                        reader.onload = (e) => {
                            const text = e.target.result;
                            parseCSV(text);
                        };

                        reader.readAsText(file);
                    });

                    // Función para parsear y mostrar vista previa del CSV
                    function parseCSV(text) {
                        const rows = text.split('\n').map(row => row.split(','));
                        csvData = rows;

                        // Limitar filas y columnas para vista previa
                        const previewRows = rows.slice(0, 10);
                        const previewCols = previewRows.map(row => row.slice(0, 6));

                        displayPreview(previewCols);
                    }

                    // Mostrar vista previa en un div
                    function displayPreview(data) {
                        const previewDiv = document.getElementById('preview');
                        let tableHTML = '<table border="1" style="width: 100%; border-collapse: collapse;">';

                        data.forEach(row => {
                            tableHTML += '<tr>';
                            row.forEach(cell => {
                                tableHTML += `<td style="padding: 5px;">${cell}</td>`;
                            });
                            tableHTML += '</tr>';
                        });

                        tableHTML += '</table>';
                        previewDiv.innerHTML = tableHTML;
                    }

                    // Función para generar el árbol de decisión
                    generatechart = () => {
                        let arrHeader = csvData[0];
                        let arrData = csvData.slice(1);

                        let dtSt = [arrHeader, ...arrData];

                        let dTree = new DecisionTreeID3(dtSt);
                        let root = dTree.train(dTree.dataset);

                        const pred = document.getElementById('data').value;
                        const arrPred = pred.split(",");
                        const predHeader = arrHeader.slice(0, arrHeader.length - 1);

                        let predict = pred !== "" ? dTree.predict([predHeader, arrPred], root) : null;
                        return {
                            dotStr: dTree.generateDotString(root),
                            predictNode: predict
                        };
                    }

                    document.getElementById('predict').onclick = function () {
                        var chart = document.getElementById("treed");
                        var { dotStr, predictNode } = generatechart();

                        if (predictNode != null) {
                            const arrHeader = csvData[0];
                            document.getElementById('prediction').innerText = arrHeader[arrHeader.length - 1] + ": " + predictNode.value;
                        } else {
                            document.getElementById('prediction').innerText = "";
                        }

                        const parsDot = vis.network.convertDot(dotStr);
                        const data = {
                            nodes: parsDot.nodes,
                            edges: parsDot.edges
                        };
                        const options = {
                            layout: {
                                hierarchical: {
                                    levelSeparation: 100,
                                    nodeSpacing: 100,
                                    parentCentralization: true,
                                    direction: 'UD',
                                    sortMethod: 'directed'
                                }
                            }
                        };
                        console.log(chart, data, options);
                        var network = new vis.Network(chart, data, options);
                    }

                    document.getElementById('btngenerate').onclick = function () {
                        var chart = document.getElementById("treed");
                        var { dotStr, predictNode } = generatechart();

                        if (predictNode != null) {
                            const arrHeader = csvData[0];
                            document.getElementById('prediction').innerText = arrHeader[arrHeader.length - 1] + ": " + predictNode.value;
                        } else {
                            document.getElementById('prediction').innerText = "";
                        }

                        const parsDot = vis.network.convertDot(dotStr);
                        const data = {
                            nodes: parsDot.nodes,
                            edges: parsDot.edges
                        };
                        const options = {
                            layout: {
                                hierarchical: {
                                    levelSeparation: 100,
                                    nodeSpacing: 100,
                                    parentCentralization: true,
                                    direction: 'UD',
                                    sortMethod: 'directed'
                                }
                            }
                        };

                        var network = new vis.Network(chart, data, options);
                    }
                </script>
            </article>
        </section>


        <!-- Contenido de Naive Bayes -->
        <section id="naive-bayes">
            <article class="box post post-excerpt">
                <header>
                    <h2><a href="#">Naive Bayes</a></h2>
                    <p></p>
                </header>
                <div class="container" style="margin-top: 5em;">
                    <div class="container-bayes" style="margin-left: 5%;">
                        <div class="row">
                            <!-- Cargar archivo CSV -->
                            <div class="col" style="align-content: center;">
                                <div class="shadow-lg p-3 mb-6 rounded" style="align-content: center;">
                                    <h3 style="margin-left: 5em;">Cargar datos desde CSV:</h3>
                                    <input type="file" id="fileInputBayes" accept=".csv" />
                                    <button id="loadDataBtn" style="margin-top: 1em;">Cargar datos</button>
                                    <br><br>
                                    <h3>Tabla de valores anteriores:</h3>
                                    <table id="tablaBayes" class="table table-primary"></table>
                                </div>
                            </div>

                            <!-- Inputs dinámicos y cálculo -->
                            <div class="col">
                                <div class="shadow-lg p-3 mb-5 rounded">
                                    <div class="card" id="selectContainer">
                                        <h3>Seleccione columnas y valores:</h3>
                                        <div>
                                            <select id="columnSelect">
                                                <option value="">Seleccione una columna</option>
                                            </select>
                                            <button id="addInputBtn">Agregar columna</button>
                                        </div>
                                        <div id="dynamic-inputs"></div>
                                        <button style="margin-left: 5em; margin-top: 1em; max-width: 150px;"
                                            id="btn">Calcular predicción</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Resultado de la predicción -->
                            <div>
                                <div class="shadow-lg p-3 mb-5 rounded">
                                    <h3>Respuesta:</h3>
                                    <table id="tablaRes" class="table table-Primary"></table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <script>
                    let datos = []; // Arreglo para almacenar los datos del CSV
                    let columnNames = []; // Nombres de las columnas
                    const selectedInputs = {}; // Para almacenar los valores seleccionados
                    let datosEnviar = [];

                    // Evento al cargar el archivo CSV
                    document.getElementById('loadDataBtn').addEventListener('click', () => {
                        const fileInput = document.getElementById('fileInputBayes');
                        const file = fileInput.files[0];

                        if (!file) {
                            alert("Por favor, seleccione un archivo CSV primero.");
                            return;
                        }

                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const text = e.target.result;
                            parseCSV(text);
                        };

                        reader.readAsText(file);
                    });

                    // Función para parsear el archivo CSV
                    function parseCSV(text) {
                        const rows = text.split('\n').map(row => row.split(','));
                        columnNames = rows[0];
                        datosEnviar = rows.slice(1).map(row => {
                            return [
                                row[0].trim(), // Primer valor como string
                                row.slice(1, -1).map(value => parseFloat(value)), // Valores intermedios como array de números
                                row[row.length - 1].trim() // Último valor como string para la clase
                            ];
                        });
                        datos = rows.slice(1).map(row => {
                            const rowData = row.map((value, index) => index === row.length - 1 ? value.trim() : parseFloat(value));
                            return rowData;
                        });
                        generateTable();
                        populateColumnSelect();
                    }

                    // Generar tabla de valores anteriores
                    function generateTable() {
                        let content = `<thead><tr>`;
                        columnNames.forEach(name => content += `<th>${name}</th>`);
                        content += `</tr></thead><tbody>`;

                        datos.forEach((fila) => {
                            content += `<tr>`;
                            fila.forEach(value => {
                                if (typeof value === "number" && !isNaN(value)) {
                                    content += `<td>${value.toFixed(2)}</td>`;
                                } else {
                                    content += `<td>${value}</td>`;
                                }
                            });
                            content += `</tr>`;
                        });

                        content += `</tbody>`;
                        document.getElementById("tablaBayes").innerHTML = content;
                    }

                    // Llenar el select con los nombres de columnas
                    function populateColumnSelect() {
                        const select = document.getElementById("columnSelect");
                        select.innerHTML = `<option value="">Seleccione una columna</option>`;
                        columnNames.slice(0, -1).forEach(name => {
                            const option = document.createElement("option");
                            option.value = name;
                            option.textContent = name;
                            select.appendChild(option);
                        });
                    }

                    // Agregar input basado en la columna seleccionada
                    document.getElementById("addInputBtn").addEventListener("click", () => {
                        const selectedColumn = document.getElementById("columnSelect").value;
                        if (selectedColumn && !selectedInputs[selectedColumn]) {
                            const label = document.createElement("label");
                            label.textContent = `Valor para ${selectedColumn}:`;
                            label.style.marginRight = "10px";

                            const input = document.createElement("input");
                            input.type = "text";
                            input.placeholder = `Valor para ${selectedColumn}`;
                            input.style.width = "40%";
                            input.style.marginBottom = "1em";
                            input.style.marginLeft = "2em";
                            input.className = "prediction-input";
                            input.setAttribute("data-column", selectedColumn);

                            const inputContainer = document.getElementById("dynamic-inputs");
                            inputContainer.appendChild(label);
                            inputContainer.appendChild(input);
                            inputContainer.appendChild(document.createElement("br"));

                            selectedInputs[selectedColumn] = input; // Guardar el input en el objeto
                        }
                    });

                    // Calcular predicción usando la función de predicción proporcionada
                    document.getElementById('btn').onclick = function (event) {
                        event.preventDefault();

                        // Obtener valores ingresados en los inputs dinámicos
                        const inputValues = [];
                        Object.values(selectedInputs).forEach(input => {
                            const value = parseFloat(input.value);
                            if (!isNaN(value)) {
                                inputValues.push(Number(value));
                            }
                        });

                        if (inputValues.length < Object.keys(selectedInputs).length) {
                            alert("Por favor, ingrese todos los valores requeridos.");
                            return;
                        }
                        var newIndividuo = ["nuevo registro", inputValues];
                        console.log("asdfadfa-----", newIndividuo);

                        // Llamada a la función de predicción de Tytus
                        let Manhattan = predecirCluster(1, datosEnviar, newIndividuo);
                        let Euclidiana = predecirCluster(2, datosEnviar, newIndividuo);
                        let content2 = `<thead>
												<tr>
													<th>Manhattan</th>
													<th>Euclidiana</th>
												</tr>
												</thead>
												<tbody>`;
                        content2 += "  <tr><td scope=\"row\">" + Manhattan + "</td> <td> " + Euclidiana + " </td> </tr>";

                        document.getElementById("tablaRes").innerHTML = content2;
                    };
                </script>
            </article>
        </section>
        <section id="newronal" style="display: none;">
            <article class="box post post-excerpt">
                <header>
                    <h2><a href="#">Example Neuronal Network</a></h2>
                    <p></p>
                </header>
                <div style="width: 100%;">
                    <h3 class="display-15 mt-5">Seleccione una operación para calcular la probabilidad</h3>
                    <select id="operationSelectNew" style="width: 60%; padding: 10px; margin: 10px 0;">
                        <option value="different">Diferente</option>
                        <option value="greater">Mayor</option>
                        <option value="lesser">Menor</option>
                    </select>
                    <br><br>
                    <input type="file" id="fileInputNew" accept=".csv" style="margin-bottom: 20px;">
                    <button id="loadDataBtnNew" style="margin-top: 1em;">Cargar datos</button>
                    <div id="columnSelectorsNew" style="display: none;">
                        <select id="firstColumnSelectNew" style="width: 60%; padding: 10px; margin: 10px 0;">
                            <option value="">Seleccione primera columna</option>
                        </select>
                        <select id="secondColumnSelectNew" style="width: 60%; padding: 10px; margin: 10px 0;">
                            <option value="">Seleccione segunda columna</option>
                        </select>
                    </div>
                    <div id="previewTableContainerNew">
                        <table id="previewTableNew" class="table table-primary"
                            style="width: 100%; margin-top: 20px; display: none;"></table>
                    </div>
                    <button id="predictBtnNew" style="margin-top: 1em; display: none;">Predecir probabilidad</button>
                    <div id="resultTableContainerNew">
                        <table id="resultTableNew" class="table table-primary"
                            style="width: 100%; margin-top: 20px; display: none;"></table>
                    </div>

                </div>
                <script>
                    let datosCSV = [];
                    let columnNamesB = [];

                    // Cargar archivo CSV y generar selectores de columnas
                    document.getElementById('loadDataBtnNew').addEventListener('click', function () {
                        const fileInput = document.getElementById('fileInputNew');
                        const file = fileInput.files[0];

                        if (!file) {
                            alert("Por favor, seleccione un archivo CSV primero.");
                            return;
                        }

                        const reader = new FileReader();

                        reader.onload = function (event) {
                            const text = event.target.result;
                            parseCSV(text);
                            generatePreviewTable();
                            document.getElementById("predictBtnNew").style.display = "inline";
                        };

                        reader.readAsText(file);
                    });

                    function parseCSV(text) {
                        const rows = text.split('\n').map(row => row.split(','));
                        columnNamesB = rows[0];
                        datosCSV = rows.slice(1).map(row => row.map(value => parseFloat(value.trim())));
                        populateColumnSelectors();
                    }

                    function populateColumnSelectors() {
                        const firstColumnSelect = document.getElementById("firstColumnSelectNew");
                        const secondColumnSelect = document.getElementById("secondColumnSelectNew");

                        firstColumnSelect.innerHTML = `<option value="">Seleccione primera columna</option>`;
                        secondColumnSelect.innerHTML = `<option value="">Seleccione segunda columna</option>`;

                        columnNamesB.forEach((col, index) => {
                            const option1 = document.createElement("option");
                            const option2 = document.createElement("option");
                            option1.value = index;
                            option2.value = index;
                            option1.textContent = col;
                            option2.textContent = col;
                            firstColumnSelect.appendChild(option1);
                            secondColumnSelect.appendChild(option2);
                        });

                        document.getElementById("columnSelectorsNew").style.display = "block";
                    }

                    function generatePreviewTable() {
                        let previewContent = `<thead><tr>`;
                        columnNamesB.forEach(name => previewContent += `<th>${name}</th>`);
                        previewContent += `</tr></thead><tbody>`;

                        // Mostrar todos los registros de datos
                        datosCSV.forEach(row => {
                            previewContent += `<tr>`;
                            row.forEach(value => previewContent += `<td>${isNaN(value) ? value : value.toFixed(2)}</td>`);
                            previewContent += `</tr>`;
                        });


                        previewContent += `</tbody>`;
                        document.getElementById("previewTableNew").innerHTML = previewContent;
                        document.getElementById("previewTableNew").style.display = "table";
                    }

                    // Entrenar la red neuronal y hacer predicción
                    document.getElementById("predictBtnNew").addEventListener("click", function () {
                        const operation = document.getElementById("operationSelectNew").value;
                        const firstColumnIndex = parseInt(document.getElementById("firstColumnSelectNew").value);
                        const secondColumnIndex = parseInt(document.getElementById("secondColumnSelectNew").value);

                        if (isNaN(firstColumnIndex) || isNaN(secondColumnIndex)) {
                            alert("Por favor, seleccione ambas columnas.");
                            return;
                        }

                        let arreglodesignado = [2, 4, 3, 2];
                        let redNeural = new NeuralNetwork(arreglodesignado);

                        for (let i = 0; i < 10000; i++) {
                            let numero1 = Math.random();
                            let numero2 = Math.random();
                            let target;

                            if (operation === "different") {
                                target = (numero1 != numero2 ? [1, 0] : [0, 1]);
                            } else if (operation === "greater") {
                                target = (numero1 > numero2 ? [1, 0] : [0, 1]);
                            } else if (operation === "lesser") {
                                target = (numero1 < numero2 ? [1, 0] : [0, 1]);
                            }

                            redNeural.Entrenar([numero1, numero2], target);
                        }

                        // Generar la tabla de resultados
                        generateResultTable(redNeural, firstColumnIndex, secondColumnIndex, operation);
                    });

                    function generateResultTable(redNeural, firstColumnIndex, secondColumnIndex, operation) {
                        let tableContent = `<thead><tr><th>${columnNamesB[firstColumnIndex]}</th><th>${columnNamesB[secondColumnIndex]}</th><th>Probabilidad</th></tr></thead><tbody>`;

                        datosCSV.forEach(row => {
                            const valor1 = row[firstColumnIndex];
                            const valor2 = row[secondColumnIndex];
                            const probabilidad = redNeural.Predecir([valor1, valor2]);

                            tableContent += `<tr><td>${valor1}</td><td>${valor2}</td><td>${probabilidad}</td></tr>`;
                        });

                        tableContent += `</tbody>`;
                        document.getElementById("resultTableNew").innerHTML = tableContent;
                        document.getElementById("resultTableNew").style.display = "table";
                    }
                </script>
            </article>
        </section>




        <section id="seccionkmeans">
            <article class="box post post-excerpt">
                <header>
                    <h2><a href="#">KMeans</a></h2>
                    <p>Seleccione el tipo de KMeans que desea implementar</p>
                </header>

                <div style="width: 100%;">
                    <!-- Selector para elegir el tipo de KMeans -->
                    <label for="kmeansTypeSelect">Seleccione el tipo de KMeans:</label>
                    <select id="kmeansTypeSelect" style="width: 60%; padding: 10px; margin: 10px 0;">
                        <option value="">Seleccione una opción</option>
                        <option value="lineal">KMeans Lineal</option>
                        <option value="2d">KMeans 2D</option>
                    </select>
                </div>

                <!-- Sección para KMeans Lineal -->
                <div id="kmeansLinealSection" style="display: none; width: 100%;">
                    <h3>KMeans Lineal</h3>
                    <div id="contLinealKm">
                        <label for="linear_data">Datos lineales (x)</label>
                        <input style="width: 60%;" id="cluster_count" type="number"
                            placeholder="Ingrese la cantidad de clusters" value="3">
                        <input style="width: 60%;" id="linear_data" type="text"
                            placeholder="Ingrese los numeros separados por comas (0,1,2,3,...)"
                            value="-99,-92,-89,-87,-83,-82,-78,-76,-70,-62,-57,-55,-50,-42,-35,-33,-32,-30,-27,-17,-12,-10,0,1,2,25,29,33,39,41,53,54,67">
                        <input style="width: 60%;" id="iterations" type="number"
                            placeholder="Ingrese la cantidad de iteraciones a realizar" value="3">
                        <button id="btnLineal">Calcular KMeans Lineal</button>
                    </div>

                    <center>
                        <div id="chartkmean" style="width: 900px; height: 500px;"></div>
                    </center>
                </div>

                <!-- Sección para KMeans 2D -->
                <div id="kmeans2DSection" style="display: none; width: 100%;">
                    <h3>KMeans 2D</h3>
                    <div id="contLinealKm">
                        <label for="linear_data2D">Datos 2D (x,y)</label>
                        <input style="width: 60%;" id="cluster_count2D" type="number"
                            placeholder="Ingrese la cantidad de clusters" value="3">
                        <input style="width: 60%;" id="linear_data2D" type="text"
                            placeholder="Ingrese los numeros separados por comas ([0,0],[0,1],[0,2]...)"
                            value="[11,6],[4,2],[15,0],[10,6],[7,8],[9,12],[13,0],[5,1],[0,13],[7,5],[6,1],[3,6],[0,10],[14,10],[6,14],[6,4],[4,9],[5,14],[9,9],[13,8]">
                        <input style="width: 60%;" id="iterations2D" type="number"
                            placeholder="Ingrese la cantidad de iteraciones a realizar" value="3">
                        <button id="btnLineal2D">Calcular KMeans 2D</button>
                    </div>
                    <div id="chart_div2D" style="width: 900px; height: 500px;"></div>
                </div>

                <script>
                    // Mostrar el formulario adecuado según la selección
                    document.getElementById('kmeansTypeSelect').addEventListener('change', function () {
                        const selectedValue = this.value;
                        document.getElementById('kmeansLinealSection').style.display = (selectedValue === 'lineal') ? 'block' : 'none';
                        document.getElementById('kmeans2DSection').style.display = (selectedValue === '2d') ? 'block' : 'none';
                    });

                    // Función para KMeans Lineal
                    document.getElementById('btnLineal').onclick = function () {
                        var linear_data = document.getElementById('linear_data').value;
                        var k = document.getElementById('cluster_count').value;
                        var iterations = document.getElementById('iterations').value;
                        var data = [];
                        var split = linear_data.split(',');

                        split.forEach(d => {
                            data.push(parseInt(d));
                        });

                        if (data.length < k) {
                            alert(`El numero de clusters (${k}) no puede ser menor a la cantidad de datos (${data.length})`);
                            return;
                        }

                        var kmeans = new LinearKMeans(k, data);
                        let clusterized_data = kmeans.clusterize(k, data, iterations);

                        let clusters = new Set([...clusterized_data.map(a => a[1])]);
                        clusters = Array.from(clusters);

                        clusters.forEach((cluster, i) => {
                            clusters[i] = [cluster, "#000000".replace(/0/g, function () { return (~~(Math.random() * 16)).toString(16); })];
                        });

                        google.charts.load('current', { 'packages': ['corechart'] });
                        google.charts.setOnLoadCallback(function () { drawChartLineal(clusters, clusterized_data) });

                        function drawChartLineal(clusters, clusterized_data) {
                            var graph_data = new google.visualization.DataTable();
                            graph_data.addColumn('number', 'X');
                            graph_data.addColumn('number', 'Y');
                            graph_data.addColumn({ type: 'string', role: 'style' });

                            let a = clusterized_data.map(e => [e[0], 0, `point { size: 7; shape-type: diamond; fill-color: ${clusters[clusters.findIndex(a => a[0] == e[1])][1]}}`]);
                            graph_data.addRows(a);

                            clusters.forEach(c => {
                                graph_data.addRow([c[0], 0, `point { size: 3; shape-type: square; fill-color: #ff0000`]);
                            });

                            var options = {
                                title: 'Puntos',
                                seriesType: 'scatter',
                                series: { 1: { type: 'line' } },
                                hAxis: { title: 'X', minValue: 0, maxValue: Math.max(data) + 10 },
                                yAxis: { title: 'Y', minValue: 0, maxValue: 5 },
                                legend: 'none'
                            };

                            var chart = new google.visualization.ScatterChart(document.getElementById('chartkmean'));
                            chart.draw(graph_data, options);
                        }
                    };

                    // Función para KMeans 2D
                    document.getElementById('btnLineal2D').onclick = function () {
                        var linear_data = document.getElementById('linear_data2D').value;
                        var k = document.getElementById('cluster_count2D').value;
                        var iterations = document.getElementById('iterations2D').value;
                        var data = [];
                        var split = linear_data.replaceAll(/\s/g, '').replaceAll('[', '').split('],');

                        split.forEach(d => {
                            var point = d.replace(']', '').split(',');
                            data.push([parseInt(point[0]), parseInt(point[1])]);
                        });

                        if (data.length < k) {
                            alert(`El numero de clusters (${k}) no puede ser menor a la cantidad de datos (${data.length})`);
                            return;
                        }

                        var kmeans = new _2DKMeans(k, data);
                        let clusterized_data = kmeans.clusterize(k, data, iterations);

                        let clusters = clusterized_data.map(a => [a[1][0], a[1][1]]);
                        clusters = clusters.filter((v, i, a) => a.findIndex(t => (JSON.stringify(t) === JSON.stringify(v))) === i);

                        clusters.forEach((cluster, i) => {
                            clusters[i] = [cluster, "#000000".replace(/0/g, function () { return (~~(Math.random() * 16)).toString(16); })];
                        });

                        google.charts.load('current', { 'packages': ['corechart'] });
                        google.charts.setOnLoadCallback(function () { drawChart2D(clusters, clusterized_data) });

                        function drawChart2D(clusters, clusterized_data) {
                            var graph_data = new google.visualization.DataTable();
                            graph_data.addColumn('number', 'X');
                            graph_data.addColumn('number', 'Y');
                            graph_data.addColumn({ type: 'string', role: 'style' });

                            let a = clusterized_data.map(e => [e[0][0], e[0][1], `point { size: 7; shape-type: diamond; fill-color: ${clusters[clusters.findIndex(a => JSON.stringify(a[0]) == JSON.stringify(e[1]))][1]}}`]);
                            graph_data.addRows(a);

                            clusters.forEach(c => {
                                graph_data.addRow([c[0][0], c[0][1], `point { size: 3; shape-type: square; fill-color: #ff0000`]);
                            });

                            var options = {
                                title: 'Puntos',
                                seriesType: 'scatter',
                                hAxis: { title: 'X' },
                                yAxis: { title: 'Y' },
                                legend: 'none'
                            };

                            var chart = new google.visualization.ScatterChart(document.getElementById('chart_div2D'));
                            chart.draw(graph_data, options);
                        }
                    };
                </script>
            </article>
        </section>




    </div>
    <script>
        let modelo = {};
        // Función para mostrar y ocultar vistas según el modelo seleccionado
        function mostrarVista(vistaId) {
            document.getElementById('lineal').style.display = 'none';
            document.getElementById('polinomial').style.display = 'none';
            document.getElementById('parametrizacion').style.display = 'none';
            document.getElementById('lineal').style.display = 'none';
            document.getElementById('polinomial').style.display = 'none';
            document.getElementById('decision-tree').style.display = 'none';
            document.getElementById('naive-bayes').style.display = 'none';
            document.getElementById('newronal').style.display = 'none';
            document.getElementById('seccionkmeans').style.display = 'none';

            if (vistaId === 'lineal') {
                if (document.getElementById(vistaId)) {
                    document.getElementById(vistaId).style.display = 'block';
                    document.getElementById('parametrizacion').style.display = 'block';
                }
            } else if (vistaId === 'polinomial') {
                if (document.getElementById(vistaId)) {
                    document.getElementById(vistaId).style.display = 'block';
                    document.getElementById('parametrizacion').style.display = 'block';
                }
            } else if (document.getElementById(vistaId)) {
                document.getElementById(vistaId).style.display = 'block';
            }


        }

        function habilitarCampos() {
            const objetivo = document.getElementById('objetivo').value;
            document.getElementById('rangoPrediccion').disabled = objetivo !== 'prediccion';
            document.getElementById('gradoPolinomio').disabled = objetivo !== 'tendencia';
        }

        function cargarDataset() {
            const csvFile = document.getElementById('csvFile').files[0];
            if (!csvFile) {
                alert("Por favor, selecciona un archivo CSV.");
                return;
            }

            const reader = new FileReader();
            reader.onload = function (event) {
                const text = event.target.result;
                procesarCSV(text);
            };
            reader.readAsText(csvFile);
        }

        function procesarCSV(text) {
            const rows = text.split('\n');
            const headers = rows[0].split(',');
            modelo.datos = rows.slice(1).map(row => row.split(',').map(parseFloat)); // Guardar dataset como números
            modelo.columnas = headers;

            // Llenar el encabezado de la tabla y opciones de selección de columnas
            document.getElementById('tablaHeader').innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>';
            document.getElementById('tablaDatos').innerHTML = modelo.datos.map(row =>
                `<tr>${row.map(value => `<td>${value}</td>`).join('')}</tr>`
            ).join('');

            // Llenar los selectores de columnas
            const columnaX = document.getElementById('columnaX');
            const columnaY = document.getElementById('columnaY');
            columnaX.innerHTML = headers.map((header, index) => `<option value="${index}">${header}</option>`).join('');
            columnaY.innerHTML = headers.map((header, index) => `<option value="${index}">${header}</option>`).join('');

            document.getElementById('datosCargados').style.display = 'block';
            document.getElementById('seleccionColumnas').style.display = 'block';
            alert("Dataset cargado correctamente.");
        }

        function configurarModelo() {
            const xIndex = parseInt(document.getElementById('columnaX').value);
            const yIndex = parseInt(document.getElementById('columnaY').value);

            modelo.variablesEntrada = modelo.datos.map(row => row[xIndex]); // Convertir a array de entrada
            modelo.variableSalida = modelo.datos.map(row => row[yIndex]);   // Convertir a array de salida

            const porcentajeTrain = parseInt(document.getElementById('porcentajeTrain').value);
            const gradoPolinomio = parseInt(document.getElementById('gradoPolinomio').value);
            const objetivo = document.getElementById('objetivo').value;

            modelo.porcentajeTrain = porcentajeTrain;
            modelo.gradoPolinomio = gradoPolinomio;
            modelo.objetivo = objetivo;

            alert(`Modelo configurado para ${objetivo}.`);
        }

        function entrenarModelo(tipo) {
            const xData = modelo.variablesEntrada;
            const yData = modelo.variableSalida;
            const trainSize = Math.floor((modelo.porcentajeTrain / 100) * xData.length);
            const xTrain = xData.slice(0, trainSize);
            const yTrain = yData.slice(0, trainSize);

            if (tipo === 'lineal') {
                modelo.entrenado = new LinearRegression();
                modelo.entrenado.fit(xTrain, yTrain);
            } else if (tipo === 'polinomial') {
                modelo.entrenado = new PolynomialRegression();
                modelo.entrenado.fit(xTrain, yTrain, modelo.gradoPolinomio);
            } else if (tipo === 'decisionTree') {
                modelo.entrenado = new DecisionTreeID3([xData, yData]);
                modelo.entrenado.train();
            } else if (tipo === 'naiveBayes') {
                modelo.entrenado = new NaiveBayes();
                modelo.entrenado.train(xTrain, yTrain);
            }

            alert(`Modelo de ${tipo} entrenado con éxito.`);
        }

        function realizarOperacion(tipo) {
            let yPred;

            if (tipo === 'lineal' || tipo === 'polinomial') {
                const xValores = modelo.objetivo === 'prediccion' && document.getElementById('rangoPrediccion').value
                    ? document.getElementById('rangoPrediccion').value.split(',').map(Number)
                    : modelo.variablesEntrada;

                yPred = modelo.entrenado.predict(xValores);
                dibujarGrafica(tipo === 'lineal' ? 'graficaLineal' : 'graficaPolinomial', modelo.variablesEntrada, modelo.variableSalida, yPred, tipo === 'lineal' ? 'Regresión Lineal' : 'Regresión Polinomial');
            } else if (tipo === 'decisionTree') {
                const xValores = modelo.variablesEntrada;
                yPred = modelo.entrenado.predict(xValores);
                document.getElementById('graficaDecisionTree').innerHTML = `Predicción: ${yPred}`;
            } else if (tipo === 'naiveBayes') {
                const xValores = modelo.variablesEntrada;
                yPred = modelo.entrenado.predict(xValores);
                document.getElementById('resultadoNaiveBayes').innerHTML = `Predicción: ${yPred}`;
            }
        }

        function dibujarGrafica(elementId, xData, yData, yPred, title) {
            google.charts.load('current', { 'packages': ['corechart'] });
            google.charts.setOnLoadCallback(() => {
                const data = new google.visualization.DataTable();
                data.addColumn('number', 'X');
                data.addColumn('number', 'Original');
                data.addColumn('number', 'Predicción');

                const filas = xData.map((x, i) => [x, yData[i], yPred[i]]);
                data.addRows(filas);

                const options = {
                    title: title,
                    hAxis: { title: 'X' },
                    vAxis: { title: 'Y' },
                    seriesType: 'scatter',
                    series: { 1: { type: 'line' } }
                };

                const chart = new google.visualization.ComboChart(document.getElementById(elementId));
                chart.draw(data, options);
            });
        }
    </script>
</body>

</html>